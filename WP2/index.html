<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Smart Authentication</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.js"></script>
  </head>
  <body>

    <h1 style="margin:20px">Smart Door Authentication</h1>

    <script type="text/javascript" src="./apiGateway-js-sdk/lib/axios/dist/axios.standalone.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/CryptoJS/rollups/hmac-sha256.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/CryptoJS/rollups/sha256.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/CryptoJS/components/hmac.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/CryptoJS/components/enc-base64.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/url-template/url-template.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/apiGatewayCore/sigV4Client.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/apiGatewayCore/apiGatewayClient.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/apiGatewayCore/simpleHttpClient.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/lib/apiGatewayCore/utils.js"></script>
    <script type="text/javascript" src="./apiGateway-js-sdk/apigClient.js"></script>



    <div class="botui-app-container" id="bot_frontend" style="margin:20px">
      <bot-ui>
        <form class="ui form">
          <div class="field">
            <label>OTP</label>
            <input type="text" name="OTP" placeholder="OTP">
          </div>
        </form>
        <button class="ui button" onclick="onsub()" style="margin:20px">Submit</button>
        <div class="ignored info ui message" id="output"></div>
      </bot-ui>
    </div>
    

    <script src="https://cdn.jsdelivr.net/vue/latest/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/botui/build/botui.js"></script>
    <script>

        function onsub() {
          
          
          let OTP = "";
          for (var element of document.getElementsByName("OTP").values()){
            OTP = element.value;          
          }
          
          var apigClient = apigClientFactory.newClient();
          apigClient.smartDoorPost(params={}, body={OTP:OTP}, additionalParams={}).then(function(result){
            console.log(result);
            if(result["status"] != 200 || result["data"]["statusCode"] == 400){
                document.getElementById("output").innerHTML = "ACCESS DENIED. PLEASE CHECK OTP OR CONTACT SYSTEM ADMINISTRATOR";
            }else{
                let name = JSON.parse(result["data"]["body"])["name"];
                success_message = "YOU HAVE LOGGED IN SUCCESSFULLY, " +  name.toUpperCase().bold() + ". WELCOME TO THE 'SECURE' SAMBIT SAHU FAN CLUB PORTAL."
                document.getElementById("output").innerHTML = success_message;
            }
            
          });
          
        }

    </script>
  </body>
</html>
